<html>
    <head>
        <title>Test page for LiveConnectSDK.</title>
        <script id="onedrive-js" type="text/javascript" src="/OneDrive.debug.js" client-id="000000006046291D"></script>
        <script type="text/javascript" src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-1.9.0.js"></script>
        <style type="text/css">
            .button {
                color: white;
                display: inline-block; 
                width: 100px;
                text-align: center;
                padding: 2px 5px;
                margin: 0px 10px;
                cursor: pointer;
            }

            .button-blue {
                background-color: #094AB1;
            }
            
            .button-blue:hover {
                background-color: #255fb9 !important;
            }
            
            .button_padding {
                padding: 2px 10px;
            }
            
            #JsOutputDiv {
                display: block;
                padding: 2px 5px;
                margin: 0px 10px;
            }
        </style> 
    </head>
    <header>Awesome Test App!</header>
    <div>
        <div id="open" class="button button-blue">Open</div>
        <div id="save" class="button button-blue">Save</div>
    </div>
    <form class="button_padding">
        <input id="file" name="file" type="file" />
    </form>
    <div id="JsOutputDiv"></div>
    <script>
        window.onload = function(){
            $("#open").click(function(){
                var options = {
                    linkType: "webViewLink",
                    multiSelect: true,
                    success: function(files){
                        log("OneDrive.open - success");
                        for (var i = 0; i < files.length; i++) {
                            log("File #" + i);
                            var file = files[i];

                            log("Name: " + file.fileName);
                            log("Link: " + file.link);
                            log("LinkType: " + file.linkType)
                            log("Size: " + file.size);

                            var thumbnails = file.thumbnails;
                            for(var j = 0; j < thumbnails.length; j++) {
                                log(thumbnails[j]);
                            }
                        }
                    },
                    cancel: function(){
                        log("OneDrive.open - user cancel");
                    }
                };

                OneDrive.open(options);
            });

            $("#save").click(function(){
                var options = {
                    file: "file",
                    fileName: "test.txt",
                    success: function(){
                        log("OneDrive.save - upload succeeded!");
                    },
                    cancel: function(){
                        log("OneDrive.save - user cancel");
                    },
                    progress: function(percent){
                        log("OneDrive.save - progress " + percent + "%");
                    },
                    error: function(errorMessage){
                        log("OneDrive.save - error " + errorMessage);
                    }
                };

                OneDrive.save(options);
            });

            function log(message) {
                var child = document.createTextNode(message);
                var parent = document.getElementById('JsOutputDiv') || document.body;
                parent.appendChild(child);
                parent.appendChild(document.createElement("br"));
            }
        };
    </script>
</html>
